<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>タイトル</title>
  <meta name="keywords" content="ページのキーワードA,B,C">
  <meta name="description" content="ページの説明">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="style.css">

<style>
	aside {
		width: 250px;
		position: fixed; 
    		top: 0;
    		left: 0;
    		height: 100%; 
    		background-color: #C3D5C7;
    		padding: 15px;
    		box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
	}
	body {
		margin: 0;
  		padding: 0;
  		font-family: Arial, sans-serif;
  		background-color: #f9f9f9; 
		line-height: 1.5;
	}
	#content {
		max-width: 750px; 
    		margin: 0 auto; 
    		padding: 30px;
		background-color: #ffffff;
		box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1); 
  		border-radius: 8px;
	}
	img {
		max-width: 80%; /* 親要素に収まるように制限 */
      		height: auto;    /* アスペクト比を保つ */
      		display: block;  /* インライン要素を解除 */
      		margin: 0 auto;  /* 中央揃え */
	}
	img.big {
		max-width: 100%; /* 親要素に収まるように制限 */
		height: auto;    /* アスペクト比を保つ */
		display: block;  /* インライン要素を解除 */
		margin: 0 auto;  /* 中央揃え */
	}
	code, pre {
		font-size: 16px; /* フォントサイズを16ptに設定 */
		font-family: Consolas, "Courier New", monospace; /* 等幅フォントを指定 */
      		background-color: #f5f5f5; /* 背景色を薄い灰色に設定 */
      		color: #333; /* フォント色 */
      		padding: 10px; /* 内側の余白を追加 */
      		border-radius: 5px; /* 角を丸める */
      		display: block; /* ブロック要素として表示 */
      		overflow-x: auto; /* 横スクロールを有効化 */
      		line-height: 1.5; /* 行間を広げる */
	}
	.spaced-br {
		display: block; /* ブロック要素に変換 */
		margin-bottom: 16px; /* 行間を調整 */
	}
	.center-text {
		text-align: center;
		margin: 20px 0;
	}
	br {
		display: block; /* ブロック要素化 */
		margin-bottom: 24px; /* 下の余白を20pxに設定 */
	}
	ul {
		padding-left: 20px;
		margin-bottom: 20px;
	}
	ul li {
		margin-bottom: 15px;
		line-height: 1.8;
		font-size: 18px;
	}
	ul li br + span {
		font-size: 16px;
		color: #555;
	}
	.link ul {
		list-style: none;
    		padding: 0;
	}
	.link ul li {
    		margin: 10px 0;
	}
  	.link ul li a {
		text-decoration: none;
		color: #333;
	}
  	.link ul li a:hover {
    		color: #007BFF; 
	}
	p {
		font-size: 16px;
		line-height: 1.6;
	}
	h3 {
		font-size: 18px;
		margin-top: 20px;
	}
	h2 {
      		font-size: 24px;
      		margin-top: 20px;
	}
	header h1 {
      		font-size: 28px;
      		margin: 20px 0;
      		text-align: center;
	}
	header p {
      		text-align: center;
      		font-size: 14px;
      		color: #666;
	}
</style>

</head>
	<body>
		<div id="outer">
			<header>
				<div id="header-container"><div id="head-inner">
					<h1>自作pcでいろいろやった</h1>
					<p class="description">東北大学大学院生命科学研究科　渡邊峰</p></div></div>
			</header>
			<aside>
				<div class="left-title"><a href="index.html">トップページ</div>
				<div class="link">
					<ul>
						<li><a href="pc_enviroment.html">pcのスペックおよび作業環境</a></li>
						<li><a href="dual_boot.html">デュアルブートにしてみた</a></li>
						<li><a href="#section3">サーバーを構築してみた</a></li>
						<li><a href="GUI_error_1.html">GUIエラーの対処 (前編)</a></li>
					</ul>
				</div>
			</aside>
			<div id="content">
				<main>
					<div id="inner">
						<h2>生じた問題</h2>
						<p>PCを操作していたら固まったので、強制再起動した．
							<br>ふだん通りUbuntuでユーザーを選択，パスワードを入力した．
							<br>いつもならここでデスクトプ画面が表示されるが，真っ暗のまま何も表示されない．
							<br>起動→OS選択→ユーザー選択までは問題なさそうだが，GUI (Graphical User Interface)に関わるどこかで不具合が起きている？
						</p>
						<P>
							この問題を解決するべくとにかくいろいろ試しまくったのその記録です。
							<br>遠回りをしていそうですが、ついでにGUIやシステム的なところについて色々知ることができたので、このまま残そうと思います。 
						</P>

						<h3>考えられる原因</h3>
						<p>
							おそらくGUIがうまく起動していないor認識されていない 
							<br>下の図は、Linuxの起動~グラフィック出力の簡易図。
							<br>今回は起動、ログインはできるけどその先のデスクトップ環境に進めない状態 
							<br>このフローのどこかに問題があると考えられる
							<img src="images/GUI_trouble/comp_mechanism.png">
							<a href="https://hrzine.jp/article/detail/37" target="_blank">https://hrzine.jp/article/detail/37</a>
						</p>
						<h4>仮想コンソールを起動する</h4>
						<p>
							Ctrl + alt + F3で仮想コンソールに入る 
							<br>仮想コンソール…GUIを必要としないプロンプト.起動時だったり、グラボがクラッシュしたあとだったり、画面がうまくつかないときに使える 
							<br>日本語対応はしていないので◆◆や？？のように文字化けする 
							<img src="images/GUI_trouble/図1.png">
						</p>
						<p>
							とりあえずGUIを再起動する 
							<code>startx</code>
							これは、X Window Systemと呼ばれる (上図のXサーバーとデスクトップ環境のイメージ)GUIシステムを起動するためのコマンド 
							<br>しかし直らず 
						</p>

						<h4>ディスプレイマネージャーについて調べる</h4>
						<h5>ディスプレイマネージャーがインストールされているかチェック</h5>
						<P>
							Ubuntu 22.04の標準ディスプレイマネージャーはgdm3 
						</P>
						<code>dpkg -l | grep gdm3 </code>
						<p>
							ｄpkgはaptみたいな感じのパッケージ管理ツール 
							ここでは、“gdm3”を含む、インストール済みのパッケージを確認 
						</p>
						<img src="images/GUI_trouble/gdm3.png">
						<code>Ⅱ gdm3  42.0-1ubuntu7.22.04.4 amd64 GNOME Display Manager</code>
						<ul>
							<li>
								ii → "installed（インストール済み）" 
								gdm3 → パッケージ名 
								42.0-1ubuntu7 → バージョン 
								amd64 → アーキテクチャ（64bit） 
								GNOME Display Manager → 説明 
							</li>
						</ul>
						<p>
							Gdmはインストールされている
							<br>gdmを再起動する
						</p>
						<code>
							sudo systemctl enable gdm3   # 有効化
							sudo systemctl start gdm3    # gdmの起動
							sudo reboot                  # システムの再起動
						</code>
						<p>
							直らず
						</p>
						<h5>gdm3のエラーログを確認 </h5>
						<code>jounalctl -xeu gdm       # gdmに関するエラーログを確認 </code>
						<img src="images/GUI_trouble/gdm_log.jpg">

						<code>GDM: Failed to contact accountsservice </code>
						<p>GDMがユーザー情報を取得できず起動に失敗している可能性がある </p>


						<h6>accountsserviceという，liuxでユーザー管理をするアプリをインストール </h6>
						<code>
							dpkg -l | grep accountsservice    
							<br># "accountsservice"を含むパーッケージがインストールされているか
						</code>
						<p>何も出力がなかったので、未インストール状態</p>
						<code>
							sudo apt install accountsservice 
							sudo reboot 
						</code>
						<p>直らず</p>

						<h4>ここまでやったこと</h4>
						<p>
							システム再起動、X window system再起動
							<br>デスクトップ環境(gdm) に問題があるかを確認した
							いずれの手順でも原因はわからなかった。
						</p>
						<h4>次回 (後編)</h4>
						<p>
							デスクトップ環境やXサーバーを含む、X window systemについて異常があるか確認する
						</p>
					</div>
				
			</div>
		</div>
	</body>
</html>
